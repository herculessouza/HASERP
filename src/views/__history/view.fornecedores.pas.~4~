unit view.fornecedores;

interface

uses
  Winapi.Windows,
   Winapi.Messages,
    System.SysUtils,
     System.Variants,
      System.Classes,
       Vcl.Graphics,
  Vcl.Controls,
  Vcl.Forms,
  Vcl.Dialogs,
  view.base.listas,
  Data.DB,
  Vcl.Grids,
  Vcl.DBGrids,
   Vcl.StdCtrls,
    Vcl.WinXCtrls,
    Vcl.WinXPanels,
     Vcl.Buttons,
  Vcl.ExtCtrls, Services.cadastro, providers.constantes, Vcl.Mask, Vcl.DBCtrls;

type
  TviewFornecedores = class(TviewBaseListas)
    Label1: TLabel;
    Label2: TLabel;
    Label3: TLabel;
    Label4: TLabel;
    Label5: TLabel;
    Label6: TLabel;
    Label8: TLabel;
    pnlTituloCadCliente: TPanel;
    lblTituloCadastro: TLabel;
    edtPES_COD: TDBEdit;
    edtPES_RAZAO: TDBEdit;
    edtPES_FANTASIA: TDBEdit;
    edtPES_TELEFONE: TDBEdit;
    edtPES_CPFCNPJ: TDBEdit;
    edtPES_IERG: TDBEdit;
    edtPES_OBSERVACAO: TDBEdit;
    procedure FormShow(Sender: TObject);
    procedure btnNovoClick(Sender: TObject);
    procedure btnEditarClick(Sender: TObject);
    procedure btnCancelarClick(Sender: TObject);
    procedure btnSalvarClick(Sender: TObject);
    procedure btnExcluirClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  viewFornecedores: TviewFornecedores;

implementation

{$R *.dfm}

procedure TviewFornecedores.btnCancelarClick(Sender: TObject);
begin    //cancelar
  inherited;
  if ServicesCadastro.Qry_Pessoas.State in dsEditModes then
     ServicesCadastro.Qry_Pessoas.Cancel;
     CPLista.ActiveCard  := card_Pesquisa;

end;

procedure TviewFornecedores.btnEditarClick(Sender: TObject);
begin  //editar
   inherited;
  CPLista.ActiveCard := card_cadastro;
  edtPES_CPFCNPJ.SetFocus;
  ServicesCadastro.Qry_Pessoas.Edit;

end;

procedure TviewFornecedores.btnExcluirClick(Sender: TObject);
begin    //excluir
  inherited;

  if ServicesCadastro.Qry_Pessoas.RecordCount > 0 then
 begin
     ServicesCadastro.Qry_Pessoas.Delete;
     ShowMessage('Fornecedor Deletado com Sucesso');
     CPLista.ActiveCard := card_pesquisa;
 end;
end;

procedure TviewFornecedores.btnNovoClick(Sender: TObject);
begin     //novo
  inherited;
 CPLista.ActiveCard := card_cadastro;
      edtPES_CPFCNPJ.SetFocus;
      ServicesCadastro.Qry_Pessoas.Insert;
end;

procedure TviewFornecedores.btnSalvarClick(Sender: TObject);
begin    //salvar
  inherited;
  if ServicesCadastro.Qry_Pessoas.State in dsEditModes then
  begin
  ServicesCadastro.Qry_PessoasPES_TIPOPESSOA.AsInteger := 2;
  ServicesCadastro.Qry_Pessoas.Post;
  showmessage('Fornecedor Salvo com Sucesso');
  CPLista.ActiveCard := card_Pesquisa;
  end;
end;

procedure TviewFornecedores.FormShow(Sender: TObject);
begin      //show
  inherited;
      GET_pessoas(2);
end;

end.
